(function(e,f){var k=f.bind(null,e,void 0);e.define instanceof Function?define(k):k()})(function(){return this}(),function(e,f){function k(g){throw Error(g);}function u(g){e.window?document.addEventListener?e.document.addEventListener("DOMContentLoaded",g,!1):e.document.attachEvent("onreadystatechange",g):setTimeout(g,0)}function h(g,b,a,c,d,l){Object.defineProperty(c,d,{value:l,writable:g,enumerable:b,configurable:a})}function v(g,b,a,c,d,l){Object.defineProperty(a,c,{get:d,set:l,enumerable:g,configurable:b})}
function r(g,b,a,c,d){for(var l in d)h(g,b,a,c,l,d[l])}function n(g,b,a){g=eval("(function () { return "+w.replace(/_x_/g,g)+"})();");a===f?(g.prototype={},a=b):g.prototype=new b(p);r(!1,!0,!0,g.prototype,a);return g}var p={},s=[].forEach||function(g,b){var a,c,d=Object(this);a=0;for(c=this.length;a<c;a++)g.call(b,this[a],a,d)},w=function b(){var a;this instanceof b||k("$eg.Base.prototype.constructor: Not use new operator.");if(b.__singleton__ instanceof b)return b.__singleton__;for(a in this)"constructor"!==
a&&h(!0,!0,!0,this,a,this[a]);r(!0,!1,!1,this,{constructor:b,__super__:b});arguments[0]!==p&&(this.__attr__ instanceof Function&&this.__attr__.call(this),this.init instanceof Function&&this.init.apply(this,arguments))}.toString(),q=n("Base",{parent:function(){var b=[],a,c;return function(d,l){this[d]instanceof Function||k('$eg.Base.prototype.parent: "'+d+'" property is not found.');var t,f,h,e,m;b.length||(a=this,c=d,b.push(this.__super__),t=!0);f=h=this.__super__;a!==this?(a=this,b.push(this.__super__),
c=d):c!=d&&(t=!0,f=b[b.length-1],c=d);e=f.prototype;for(m=f.prototype[d];e[d]===m;f=e.__super__,e=f.prototype);this.__super__=f;f=e[d].apply(this,l);this.__super__=h;t&&b.pop();return f}}(),binding:function(b,a){var c=[].slice.call(arguments);a.unshift(this);return Function.prototype.bind.apply(this[b],c)},defstatic:function(){return function(b,a){var c=this.constructor;c["__static__"+b]===f&&(c["__static__"+b]=a);v(!0,!0,this,b,function(){return c["__static__"+b]},function(a){c["__static__"+b]=a})}}(),
destroy:function(){for(var b in this)this[b]instanceof q&&this[b].destroy()}}),x=n("ClassContext",q,{init:function(b,a){b instanceof m&&b[a]instanceof Function||k('$eg.ClassContext: "'+a+'" is not found.');this.namespace=b;this.clazz=b[a]},extend:function(b){if("string"==typeof b){var a=this.clazz;var c=this.namespace;c.__base__!==f&&c[b]!==f||c[b]!==f||k('$eg.ClassContext.extend: "'+b+'" is not found.');b=c[b];a.prototype=new b(p)}else this.clazz.prototype=b.prototype instanceof this.namespace.__parent__.Base?
new b(p):Object.create(b.prototype,{init:{value:b,writable:!1,enumerable:!0,configurable:!0}});h(!1,!1,!1,this.clazz,"base",this.clazz.prototype.constructor);return this},def:function(b){r(!1,!0,!0,this.clazz.prototype,b);return this.namespace}}),m=n("SpaceBase",q,{init:function(b){b===f&&(b=this,h(!1,!0,!1,this,"Base",q),h(!1,!0,!1,this,"ClassContext",x),h(!1,!0,!1,this,"NameSpace",m));h(!1,!1,!1,this,"__parent__",b||this)},Class:function(){var b=[];u(function(){var a,c;a=0;for(c=b.length;a<c;a++)new b[a]});
return function(a){var c=this.__base__||this,d=n(a,this.Base||this.__parent__.Base,{});this[a]!==f&&k('$egNameSpace.Class: "'+a+'" is not replace.');"Main"==a&&b.push(d);h(!1,!0,!1,c,a,d);return new this.__parent__.ClassContext(this,a)}}(),method:function(b,a){h(!1,!0,!1,this.__base__||this,b,a);return this},space:function(b){var a=new m(this.__parent__);this[b]!==f&&k('$eg.NameSpace.space: "'+b+'" is not replace.');h(!1,!0,!1,this.__base__||this,b,a);return a.wrap()},wrap:function(){return Object.create(this,
{__base__:{value:this,writable:!1,enumerable:!1,configurable:!1}})},include:function(b){for(var a in b)"Base"!=a&&(this[a]===f&&(b[a]instanceof Function||b[a]instanceof this.__parent__.SpaceBase))&&h(!1,!0,!1,this,a,b[a]);return this},search:function(b){var a=[],c=this.__base__||this;b instanceof Function||k('$eg.NameSpace.prototype.search: "'+b.name+'" is not a class.');(function l(c,f,e){for(f in c)e=c[f],e instanceof m?l(e):e instanceof Function&&e.prototype instanceof b&&a.push(e)})(c);return a}});
(function(b){b.space("Observer").Class("Listener").def({init:function(a){this.self=a;this.listeners={};this.appendelems=[]},add:function(a,b){(this.listeners[a]==f?this.listeners[a]=[]:this.listeners[a]).push(b)},remove:function(a,b){for(var d,e=this.listeners[a]==f?[]:this.listeners[a];-1!=(d=e.indexOf(b));)e.splice(d,1)},append:function(a,b,d){var e,f,h,k=this.appendelems;this.call(d,a.addEventListener||a.attachEvent);var m=(void 0).call(a,b,m);d=0;for(e=k.length;d<e;d++)f=k[d],f.elem===a&&(f.childs.push({type:b,
func:m}),h=!0);h||k.push({elem:a,childs:[{type:b,func:m}]})},call:function(a,b){var d,f,e=this.listeners[a]||[],e=[].slice.call(e);d=0;for(f=e.length;d<f;d++)e[d].call(this.self,b);if(this.self["on"+a]instanceof Function)this.self["on"+a](b)},bind:function(a){return this.call.bind(this,a)},destroy:function(){this.call("destroy");this.listeners={};s.call(this.instanceelems,function(a){var b=a.elem;s.call(a.childs,function(a){(b.removeEventListener||b.detachEvent)(a.type,a.func)})})}});b.space("Collection").Class("WeakMap").def({__attr__:function(){this.defstatic("HIDDEN_NAME",
"__weakmap__")},getHiddenRecord:function(a){var b=a[this.HIDDEN_NAME];if(b&&b.key===a)return b;b={key:a,gets:[],vals:[]};h(!1,!1,!1,a,this.HIDDEN_NAME,b);return b},has:function(a){return this.get!==f},set:function(a,b){var d=this.getHiddenRecord(a),e;d&&(e=d.gets.indexOf(this),0<=e?d.vals[e]=b:(d.gets.push(this),d.vals.push(b)))},get:function(a){a=getHiddenRecord(a);var b;a&&(b=a.gets.indexOf(this),b=a.vals[b]);return b}});b.space("Extender").Class("Singleton").def({__attr__:function(){this.constructor.__singleton__===
f&&h(!1,!1,!0,this.constructor,"__singleton__",this)},destroy:function(){delete this.constructor.__singleton__;this.parent("destroy")}}).Class("Array").def({push:[].push,unshift:[].unshift,pop:[].pop,shift:[].shift,indexOf:[].indexOf,lastIndexOf:[].lastIndexOf,sort:[].sort,reverse:[].reverse,slice:[].slice,splice:[].splice,join:[].join,forEach:s,toString:[].toString,valueOf:[].valueOf,length:0});b.space("File").Class("Loader").def({__attr__:function(){var a=this,c=this.createXHR();this.xhr=c;this.listener=
new b.Observer.Listener(this);this.runnable=!1;this._loadurl="";this._loadedfiles={};c.onreadystatechange=function(){var b;4==c.readyState&&(200==c.status?(a._loadedfiles[a._loadurl]&&(b=!0),a._loadedfiles[a._loadurl]={type:c.getResponseHeader("Content-Type"),url:a._loadurl,extension:a._loadurl.match(/\.[^\.]*/)[0].replace(/\./,""),lasttime:+new Date(c.getResponseHeader("Last-Modified")),loadtime:+new Date,text:c.responseText},b?a.listener.call("refresh",a._loadedfiles[a._loadurl]):a.listener.call("response",
a._loadedfiles[a._loadurl]),a.listener.call("change",a._loadedfiles[a._loadurl])):a.listener.call("error",c.status),a.runnable=!1)}},createXHR:function(){return new XMLHttpRequest},allRefresh:function(){for(var a in this._loadedfiles)this.refresh(this._loadedfiles[a].url)},refresh:function(a){var b;this.xhr.open("HEAD",a,!1);this.xhr.send();3!=xhr.readyState&&(b=+new Date(this.xhr.getResponseHeader("Last-Modified")),b>this._loadedfiles[a].lasttime&&this.load(a))},load:function(a,b){this._loadurl=
a;this.runnable=!0;this.xhr.open("GET",a,!0);this.xhr.send();b instanceof Function&&this.listener.add("response",function l(a){b.call(this,a);this.listener.remove("responce",l)})},response:function(a){return this._loadedfiles[a]}})})(e.$eg=new m)});(function(){var e;e=$eg.space("UI");e.include($eg.Extender).method("execute",function(){return(new e.Main).execute()}).Class("Main").extend(e.Singleton).def({init:function(){return this.message="HelloWorld"},execute:function(){return console.log(this.message)}})}).call(this);
